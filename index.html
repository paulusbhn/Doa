<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=no">
    <title>Buku Doa Katolik Digital</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <style>
        :root { --gold: #d4af37; --bg: #000000; }
        
        body, html { 
            margin: 0; padding: 0; width: 100%; height: 100%; 
            background: var(--bg); color: white; overflow: hidden; font-family: sans-serif;
        }

        /* Container Slide */
        .slider-wrapper {
            width: 100%; height: 100%;
            display: flex; transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .doa-slide {
            min-width: 100%; height: 100%;
            position: relative; display: flex; justify-content: center; align-items: center;
            overflow: hidden; background: #000;
        }

        .zoom-container { width: 100%; height: 100%; display: flex; justify-content: center; align-items: center; touch-action: none; }
        .doa-image { max-width: 100%; max-height: 100%; object-fit: contain; }

        /* Overlay UI */
        header {
            position: fixed; top: 0; width: 100%; z-index: 100;
            background: linear-gradient(to bottom, rgba(0,0,0,0.8), transparent);
            padding: 15px 0; text-align: center;
        }
        .search-bar { width: 70%; padding: 8px 15px; border-radius: 20px; border: 1px solid #444; background: #222; color: white; }

        /* Tombol Navigasi Samping (Khas Galeri HP) */
        .nav-btn {
            position: fixed; top: 50%; transform: translateY(-50%);
            background: rgba(255,255,255,0.1); border: none; color: white;
            padding: 20px 10px; font-size: 24px; z-index: 200; border-radius: 5px;
        }
        .prev-btn { left: 0; }
        .next-btn { right: 0; }

        /* Panel Kontrol Bawah */
        .bottom-ui {
            position: fixed; bottom: 0; width: 100%; z-index: 300;
            background: rgba(10, 10, 10, 0.9); border-top: 1px solid #333;
            padding-bottom: env(safe-area-inset-bottom);
        }
        .info-area { text-align: center; padding: 10px; }
        .controls { display: flex; justify-content: center; gap: 10px; padding-bottom: 10px; }
        
        .btn { 
            background: #333; color: white; border: 1px solid var(--gold); 
            padding: 8px 15px; border-radius: 5px; font-size: 13px;
        }

        .prayer-text-box {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 85%; max-height: 70%; background: rgba(0,0,0,0.95);
            padding: 20px; border-radius: 15px; border: 1px solid var(--gold);
            display: none; z-index: 1000; overflow-y: auto;
        }

        audio { width: 90%; height: 35px; filter: invert(1); margin-bottom: 5px; }
    </style>
</head>
<body>

<header>
    <input type="text" id="search" class="search-bar" placeholder="Cari Doa...">
</header>

<button class="nav-btn prev-btn" onclick="moveSlide(-1)">‚ùÆ</button>
<button class="nav-btn next-btn" onclick="moveSlide(1)">‚ùØ</button>

<div class="slider-wrapper" id="slider">
    </div>

<div class="prayer-text-box" id="modal-text">
    <div id="text-content" style="white-space: pre-line; line-height: 1.6;"></div>
    <br>
    <button class="btn" style="width:100%" onclick="closeText()">TUTUP</button>
</div>

<div class="bottom-ui">
    <div class="info-area">
        <div id="curr-title" style="color:var(--gold); font-weight:bold; margin-bottom:5px;">Judul Doa</div>
        <audio id="audio-player" controls></audio>
    </div>
    <div class="controls" id="audio-btns">
        </div>
</div>

<script>
    const dataDoa = [
        { id: 1, title: "Malaikat Tuhan", img: "1.jpg", text: "Maria menerima kabar...", audios: [{name: "Vokal 1", file: "1.mp3"}, {name: "Vokal 2", file: "11.mp3"}] },
        { id: 2, title: "Doa Santo Mikael", img: "2.jpg", text: "Santo Mikael...", audios: [{name: "Suara Pria", file: "2.mp3"}] },
        { id: 3, title: "Ratu Surga", img: "3.jpg", text: "Ratu Surga bersukacitalah...", audios: [{name: "Lagu", file: "3.mp3"}] }
    ];

    let currentIndex = 0;
    const slider = document.getElementById('slider');

    function init() {
        dataDoa.forEach((item, index) => {
            const slide = document.createElement('div');
            slide.className = 'doa-slide';
            slide.innerHTML = `
                <div class="zoom-container" id="z-cont-${index}">
                    <img src="assets/${item.img}" class="doa-image" id="img-${index}">
                </div>
            `;
            slider.appendChild(slide);
            setupZoom(`z-cont-${index}`, `img-${index}`);
        });
        updateUI();
    }

    function moveSlide(direction) {
        currentIndex += direction;
        if (currentIndex < 0) currentIndex = 0;
        if (currentIndex >= dataDoa.length) currentIndex = dataDoa.length - 1;
        
        slider.style.transform = `translateX(-${currentIndex * 100}%)`;
        updateUI();
    }

    function updateUI() {
        const item = dataDoa[currentIndex];
        document.getElementById('curr-title').innerText = item.title;
        
        const btnArea = document.getElementById('audio-btns');
        btnArea.innerHTML = `<button class="btn" onclick="openText()">üìÑ Lihat Teks</button>`;
        item.audios.forEach(aud => {
            btnArea.innerHTML += `<button class="btn" onclick="playAudio('${aud.file}')">üéµ ${aud.name}</button>`;
        });
    }

    function setupZoom(contId, imgId) {
        const el = document.getElementById(contId);
        const img = document.getElementById(imgId);
        const mc = new Hammer.Manager(el);
        mc.add(new Hammer.Pinch());
        mc.add(new Hammer.Pan({ direction: Hammer.DIRECTION_ALL }));

        let scale = 1, lastScale = 1, posX = 0, posY = 0, lastPosX = 0, lastPosY = 0;

        mc.on("pinchmove", (e) => {
            scale = Math.max(1, Math.min(lastScale * e.scale, 4));
            update();
        });
        mc.on("pinchend", () => { 
            lastScale = scale; 
            if(scale <= 1.1) { scale = 1; posX = 0; posY = 0; lastPosX = 0; lastPosY = 0; update(); }
        });
        mc.on("panmove", (e) => {
            if (scale > 1) {
                posX = lastPosX + e.deltaX;
                posY = lastPosY + e.deltaY;
                update();
            }
        });
        mc.on("panend", () => { lastPosX = posX; lastPosY = posY; });

        function update() { img.style.transform = `translate(${posX}px, ${posY}px) scale(${scale})`; }
    }

    function openText() {
        document.getElementById('text-content').innerText = dataDoa[currentIndex].text;
        document.getElementById('modal-text').style.display = 'block';
    }
    function closeText() { document.getElementById('modal-text').style.display = 'none'; }
    function playAudio(f) { const p = document.getElementById('audio-player'); p.src = `assets/${f}`; p.play(); }

    init();
</script>
</body>
</html>
